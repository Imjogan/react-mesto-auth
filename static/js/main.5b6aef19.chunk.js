(this["webpackJsonpmesto-react-auth"]=this["webpackJsonpmesto-react-auth"]||[]).push([[0],{19:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),i=n(21),s=n.n(i),r=(n(19),n(4)),o=n(25),l=n(2),u=n(3),m=n(8),d=n(0);var j=function(e){var t=e.email,n=e.onSignOut,c=e.onMenuClick,i=Object(u.h)(),s=Object(u.g)(),r=Object(a.useState)(!1),o=Object(l.a)(r,2),j=o[0],b=o[1];return Object(a.useEffect)((function(){b(!1)}),[i]),Object(d.jsxs)("header",{className:"header",children:[Object(d.jsx)("figure",{className:"header__logo"}),"/sign-in"===i.pathname?Object(d.jsx)(m.b,{to:"/sign-up",className:"header__element",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}):"/sign-up"===i.pathname?Object(d.jsx)(m.b,{to:"/sign-in",className:"header__element",children:"\u0412\u043e\u0439\u0442\u0438"}):Object(d.jsxs)(d.Fragment,{children:[Object(d.jsxs)("nav",{className:"header__menu",children:[Object(d.jsx)("p",{className:"header__menu-element",children:t}),Object(d.jsx)("button",{onClick:function(){n(),localStorage.removeItem("token"),s.push("/sign-in")},className:"header__menu-element header__menu-element_button",children:"\u0412\u044b\u0439\u0442\u0438"})]}),Object(d.jsx)("nav",{className:"burger",children:Object(d.jsx)("figure",{onClick:function(){b(!j),c()},className:"burger__button burger__button_type_cross ".concat(j&&"burger__button_active"),children:Object(d.jsx)("span",{className:"burger__contain"})})})]})]})},b=n.p+"static/media/filler.6c929a1e.jpg";var f=function(e){var t=e.src,n=e.alt,c=e.onClick,i=e.className,s=Object(a.useState)(!1),r=Object(l.a)(s,2),o=r[0],u=r[1];return Object(a.useEffect)((function(){return u(!1)}),[t]),Object(d.jsx)("img",{onClick:c,src:o?b:t,alt:"\u0424\u043e\u0442\u043e: ".concat(n||""),className:i,onError:function(){u(!0)}})},_=c.a.createContext();var O=function(e){var t=e.getCard,n=e.card,c=e.onCardLike,i=e.onCardDelete,s=Object(a.useContext)(_),r=n.owner._id===s._id,o=n.likes.some((function(e){return e._id===s._id})),l="element__like\n    ".concat(o&&"element__like_active"),u="element__trash-button\n    ".concat(r&&"element__trash-button_visible");return Object(d.jsxs)("li",{className:"element",children:[Object(d.jsx)("button",{onClick:function(){i(n)},type:"button",className:u}),Object(d.jsx)(f,{src:n.link,alt:n.name,className:"element__image",onClick:function(){t(n)}}),Object(d.jsxs)("div",{className:"element__container",children:[Object(d.jsxs)("h2",{className:"element__title",children:[" ",n.name," "]}),Object(d.jsxs)("div",{className:"element__like-group",children:[Object(d.jsx)("button",{onClick:function(){c(n)},type:"button",className:l}),Object(d.jsxs)("h3",{className:"element__like-counter",children:[" ",n.likes.length," "]})]})]})]})};var h=function(e){var t=e.onEditProfile,n=e.onAddPlace,c=e.onEditAvatar,i=e.onCardClick,s=e.cards,r=e.onCardLike,o=e.onCardDelete,l=Object(a.useContext)(_);return Object(d.jsxs)("main",{className:"main",children:[Object(d.jsxs)("section",{className:"profile",children:[Object(d.jsxs)("div",{className:"profile__container",children:[Object(d.jsx)("a",{onClick:c,target:"_self",href:"#",className:"profile__cover",children:Object(d.jsx)("img",{alt:"\u0410\u0432\u0430\u0442\u0430\u0440 \u043f\u043e\u043b\u044c\u0437\u043e\u0432\u0430\u0442\u0435\u043b\u044f ".concat(l.name),src:l.avatar,className:"profile__avatar"})}),Object(d.jsxs)("div",{className:"profile__info",children:[Object(d.jsx)("h1",{className:"profile__name",children:l.name}),Object(d.jsx)("button",{onClick:t,type:"button",className:"profile__button-edit"}),Object(d.jsx)("p",{className:"profile__status",children:l.about})]})]}),Object(d.jsx)("button",{onClick:n,type:"button",className:"profile__button-add"})]}),Object(d.jsx)("section",{children:Object(d.jsx)("ul",{className:"elements",children:s.map((function(e){return Object(d.jsx)(O,{onCardDelete:o,onCardLike:r,getCard:i,card:e},e._id)}))})})]})};var p=function(){var e=new Date;return Object(d.jsx)("footer",{className:"footer",children:Object(d.jsxs)("p",{className:"footer__copyright",children:["\xa9 ",e.getFullYear(),". Mesto-React, Russia"]})})};var g=function(e){var t=e.name,n=e.title,a=e.submitButtonText,c=e.isOpen,i=e.onClose,s=e.onSubmit,r=e.children,o=e.isValidity,l=e.isSubmitting,u=e.isDisabledDefault||o||l;return Object(d.jsx)("section",{className:"popup ".concat(c&&"popup_opened"),children:Object(d.jsxs)("div",{className:"popup__container",children:[Object(d.jsx)("button",{onClick:i,type:"button",className:"popup__button-close"}),Object(d.jsx)("h2",{className:"popup__title",children:n}),Object(d.jsxs)("form",{onSubmit:s,noValidate:!0,name:"form-".concat(t),className:"form",children:[r,Object(d.jsx)("button",{disabled:u,type:"submit",className:"form__button ".concat(u&&"form__button_disabled"),children:a})]})]})})};var x=function(e){var t=e.isOpen,n=e.onClose,a=e.onDeleteCard,c=e.card,i=e.isLoading,s=e.isSubmitting;return Object(d.jsx)(g,{name:"delete-confirm",title:"\u0412\u044b \u0443\u0432\u0435\u0440\u0435\u043d\u044b?",submitButtonText:i?"\u0423\u0434\u0430\u043b\u0435\u043d\u0438\u0435...":"\u0414\u0430",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),a(c)},isSubmitting:s})};var v=function(e){var t=e.card,n=e.onClose;return Object(d.jsx)("section",{className:"popup ".concat(t&&"popup_opened"),children:Object(d.jsxs)("div",{className:"popup__zoom-image",children:[Object(d.jsx)("button",{onClick:n,type:"button",className:"popup__button-close"}),Object(d.jsx)(f,{src:t&&t.link,alt:t&&t.name,className:"popup__image"}),Object(d.jsxs)("h2",{className:"popup__title-zoom-image",children:[" ",t&&t.name," "]})]})})},N=n(9),k=function(e,t){return Object.keys(e).map((function(n){var a=e[n](t);return Object(N.a)({},n,a)})).reduce((function(e,t){return Object(r.a)(Object(r.a)({},e),t)}),{})},C={userName:{required:function(e){return""===e},minLength:function(e){return e.length<2},maxLength:function(e){return e.length>40}},description:{required:function(e){return""===e},minLength:function(e){return e.length<2},maxLength:function(e){return e.length>200}}};var S=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,i=e.isLoading,s=e.isSubmitting,o=Object(a.useState)(!0),u=Object(l.a)(o,2),m=u[0],j=u[1],b=Object(a.useContext)(_),f=Object(a.useState)({userName:"",description:""}),O=Object(l.a)(f,2),h=O[0],p=O[1],x=Object(a.useState)({userName:{required:!0,minLength:!0,maxLength:!0},description:{required:!0,minLength:!0,maxLength:!0}}),v=Object(l.a)(x,2),S=v[0],L=v[1];Object(a.useEffect)((function(){void 0!==b.name&&void 0!==b.about&&p({userName:b.name,description:b.about}),j(!0)}),[t,b]);var y=Object(a.useCallback)((function(e){j(!1);var t=e.target,n=t.name,a=t.value;p((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(N.a)({},n,a))}))}),[p]);Object(a.useEffect)((function(){var e=h.userName,t=h.description,n=k(C.userName,e),a=k(C.description,t);L({userName:n,description:a})}),[h,L]);var q=h.userName,w=h.description,E=Object.values(S.userName).some(Boolean),P=Object.values(S.description).some(Boolean),D=E||P,T=S.userName.required||S.userName.minLength,U=S.description.required||S.description.minLength;return Object(d.jsx)(g,{name:"profile-edit",title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",submitButtonText:i?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:q,about:w})},isValidity:D,isSubmitting:s,isDisabledDefault:m,children:Object(d.jsxs)("fieldset",{className:"form__fields",children:[Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"text",className:"form__input ".concat(E&&"form__input_type_error"),name:"userName",required:!0,minLength:2,maxLength:40,id:"profile-name-input",value:q,onChange:y}),Object(d.jsxs)("span",{className:"form__error ".concat(E&&"form__error_visible"),children:[T?S.userName.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0440\u0430\u0437\u0443 \u043d\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 ".concat(2," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):"",S.userName.maxLength&&"\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043b \u043b\u0438\u043c\u0438\u0442 \u0432 ".concat(40," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")]})]}),Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"text",className:"form__input ".concat(P&&"form__input_type_error"),name:"description",required:!0,minLength:2,maxLength:200,id:"profile-status-input",value:w,onChange:y}),Object(d.jsxs)("span",{className:"form__error ".concat(P&&"form__error_visible"),children:[U?S.description.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0440\u0430\u0437\u0443 \u043d\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 ".concat(2," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):"",S.description.maxLength&&"\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043b \u043b\u0438\u043c\u0438\u0442 \u0432 ".concat(200," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")]})]})]})})};var L=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,i=e.isLoading,s=e.isSubmitting,r=Object(a.useRef)();return Object(a.useEffect)((function(){r.current.value=""}),[t]),Object(d.jsx)(g,{name:"update-avatar",title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",submitButtonText:i?"\u0421\u043e\u0445\u0440\u0430\u043d\u0435\u043d\u0438\u0435...":"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({avatar:r.current.value})},isSubmitting:s,children:Object(d.jsx)("fieldset",{className:"form__fields",children:Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u0444\u043e\u0442\u043e\u0433\u0440\u0430\u0444\u0438\u044e",className:"form__input form__input_field_avatar-link",name:"avatarLink",required:!0,id:"avatar-link-input",ref:r}),Object(d.jsx)("span",{className:"form__error avatar-link-input-error"})]})})})},y={cardName:{required:function(e){return""===e},minLength:function(e){return e.length<2},maxLength:function(e){return e.length>30}},cardLink:{required:function(e){return""===e},url:function(e){return!/^(ftp|http|https):\/\/[^ "]+$/.test(e)}}};var q=function(e){var t=e.isOpen,n=e.onClose,c=e.onAddPlace,i=e.isLoading,s=e.isSubmitting,o=Object(a.useState)(!0),u=Object(l.a)(o,2),m=u[0],j=u[1],b=Object(a.useState)({cardName:"",cardLink:""}),f=Object(l.a)(b,2),_=f[0],O=f[1],h=Object(a.useState)({cardName:{required:!0,minLength:!0,maxLength:!0},cardLink:{required:!0,url:!0}}),p=Object(l.a)(h,2),x=p[0],v=p[1];Object(a.useEffect)((function(){O({cardName:"",cardLink:""}),j(!0)}),[t]);var C=Object(a.useCallback)((function(e){j(!1);var t=e.target,n=t.name,a=t.value;O((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(N.a)({},n,a))}))}),[O]);Object(a.useEffect)((function(){var e=_.cardName,t=_.cardLink,n=k(y.cardName,e),a=k(y.cardLink,t);v({cardName:n,cardLink:a})}),[_,v]);var S=_.cardName,L=_.cardLink,q=Object.values(x.cardName).some(Boolean),w=Object.values(x.cardLink).some(Boolean),E=q||w,P=x.cardName.required||x.cardName.minLength,D=x.cardLink.required||x.cardLink.url;return Object(d.jsx)(g,{name:"card-add",title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",submitButtonText:i?"\u0414\u043e\u0431\u0430\u0432\u043b\u0435\u043d\u0438\u0435...":"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:S,link:L})},isValidity:E,isSubmitting:s,isDisabledDefault:m,children:Object(d.jsxs)("fieldset",{className:"form__fields",children:[Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"text",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",className:"form__input ".concat(m?"":q&&"form__input_type_error"),name:"cardName",required:!0,minLength:2,maxLength:30,id:"card-name-input",value:S,onChange:C}),Object(d.jsxs)("span",{className:"form__error ".concat(m?"":q&&"form__error_visible"),children:[P?x.cardName.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0440\u0430\u0437\u0443 \u043d\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 ".concat(2," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):"",x.cardName.maxLength&&"\u041f\u0440\u0435\u0432\u044b\u0448\u0435\u043b \u043b\u0438\u043c\u0438\u0442 \u0432 ".concat(30," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432")]})]}),Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"url",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",className:"form__input ".concat(m?"":w&&"form__input_type_error"),name:"cardLink",required:!0,id:"card-link-input",value:L,onChange:C}),Object(d.jsx)("span",{className:"form__error ".concat(m?"":w&&"form__error_visible"),children:D?x.cardLink.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 URL":""})]})]})})},w=n(23),E=n(24),P=new(function(){function e(t){Object(w.a)(this,e),this._baseUrl=t.baseUrl,this._headers=t.headers}return Object(E.a)(e,[{key:"getCards",value:function(){return fetch("".concat(this._baseUrl,"/cards"),{method:"GET",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getUserInfo",value:function(){return fetch("".concat(this._baseUrl,"/users/me"),{method:"GET",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"getInitialData",value:function(){return Promise.all([this.getCards(),this.getUserInfo()])}},{key:"setUserInfo",value:function(e,t){return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e,about:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"createCard",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e,link:t})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"deleteCard",value:function(e){return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"toggleCardLike",value:function(e,t){return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:t?"DELETE":"PUT",headers:this._headers}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}},{key:"updateAvatar",value:function(e){return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430: ".concat(e.status))}))}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-21",headers:{authorization:"a3ab0050-d01a-4f5a-9bb4-4a039b0aa641","Content-Type":"application/json"}});var D=function(){return Object(d.jsx)("div",{className:"loader-ring",children:Object(d.jsxs)("div",{className:"loader-ring__main",children:[Object(d.jsx)("div",{className:"loader-ring__child"}),Object(d.jsx)("div",{className:"loader-ring__child"}),Object(d.jsx)("div",{className:"loader-ring__child"}),Object(d.jsx)("div",{className:"loader-ring__child"})]})})},T=n(26),U=function(e){var t=e.component,n=Object(T.a)(e,["component"]);return Object(d.jsx)(u.b,{children:function(){return n.loggedIn?Object(d.jsx)(t,Object(r.a)({},n)):Object(d.jsx)(u.a,{to:"/sign-in"})}})},A="https://auth.nomoreparties.co",B={password:{required:function(e){return""===e},minLength:function(e){return e.length<2}},email:{required:function(e){return""===e},email:function(e){return!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}}};var I=function(e){var t=e.handleLogin,n=Object(u.g)(),c=Object(a.useState)(!0),i=Object(l.a)(c,2),s=i[0],o=i[1],m=Object(a.useState)(!1),j=Object(l.a)(m,2),b=j[0],f=j[1],_=Object(a.useState)({password:"",email:""}),O=Object(l.a)(_,2),h=O[0],p=O[1];Object(a.useEffect)((function(){return o(!0),function(){p({password:"",email:""})}}),[]);var g=Object(a.useState)({password:{required:!0,minLength:!0},email:{required:!0,email:!0}}),x=Object(l.a)(g,2),v=x[0],C=x[1],S=Object(a.useCallback)((function(e){o(!1);var t=e.target,n=t.name,a=t.value;p((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(N.a)({},n,a))}))}),[p]);Object(a.useEffect)((function(){var e=h.password,t=h.email,n=k(B.password,e),a=k(B.email,t);C({password:n,email:a})}),[h,C]);var L=h.password,y=h.email,q=Object.values(v.password).some(Boolean),w=Object.values(v.email).some(Boolean),E=q||w,P=v.password.required||v.password.minLength,D=v.email.required||v.email.email,T=s||E||b;return Object(d.jsxs)("section",{className:"login",children:[Object(d.jsxs)("div",{className:"login__container",children:[Object(d.jsx)("h2",{className:"login__title",children:"\u0412\u0445\u043e\u0434"}),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),f(!0),function(e,t){return fetch("".concat(A,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.json()})).then((function(e){if(e)return localStorage.setItem("token",e.token),e})).catch((function(e){return console.log(e)}))}(h.password,h.email).then((function(e){e.token&&(localStorage.setItem("token",e.token),t(),n.push("/main"))})).catch((function(e){return console.log(e)})).finally((function(){o(!0),f(!1)}))},noValidate:!0,name:"login",className:"form",children:[Object(d.jsxs)("fieldset",{className:"form__fields",children:[Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"email",placeholder:"Email",className:"form__input form__input_location_sign ".concat(s?"":w&&"form__input_type_error"),name:"email",required:!0,id:"email-input",value:y,onChange:S}),Object(d.jsx)("span",{className:"form__error ".concat(s?"":w&&"form__error_visible"),children:D?v.email.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 Email-\u0430\u0434\u0440\u0435\u0441":""})]}),Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"text",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"form__input form__input_location_sign ".concat(s?"":q&&"form__input_type_error"),name:"password",required:!0,minLength:2,id:"password-input",value:L,onChange:S}),Object(d.jsx)("span",{className:"form__error ".concat(s?"":q&&"form__error_visible"),children:P?v.password.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0440\u0430\u0437\u0443 \u043d\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 ".concat(2," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):""})]})]}),Object(d.jsx)("button",{disabled:T,type:"submit",className:"form__button form__button_location_sign ".concat(T&&"form__button_disabled"),children:b?"\u0412\u0445\u043e\u0434...":"\u0412\u043e\u0439\u0442\u0438"})]})]}),Object(d.jsx)("div",{className:"login__footer"})]})},R={password:{required:function(e){return""===e},minLength:function(e){return e.length<2}},email:{required:function(e){return""===e},email:function(e){return!/^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}}};var z=function(e){var t=e.onShowPopup,n=e.onRegistrationResolve,c=Object(a.useState)(!0),i=Object(l.a)(c,2),s=i[0],o=i[1],u=Object(a.useState)(!1),j=Object(l.a)(u,2),b=j[0],f=j[1],_=Object(a.useState)({password:"",email:""}),O=Object(l.a)(_,2),h=O[0],p=O[1],g=Object(a.useState)({password:{required:!0,minLength:!0},email:{required:!0,email:!0}}),x=Object(l.a)(g,2),v=x[0],C=x[1];Object(a.useEffect)((function(){return o(!0),function(){p({password:"",email:""})}}),[]);var S=Object(a.useCallback)((function(e){o(!1);var t=e.target,n=t.name,a=t.value;p((function(e){return Object(r.a)(Object(r.a)({},e),{},Object(N.a)({},n,a))}))}),[p]);Object(a.useEffect)((function(){var e=h.password,t=h.email,n=k(R.password,e),a=k(R.email,t);C({password:n,email:a})}),[h,C]);var L=h.password,y=h.email,q=Object.values(v.password).some(Boolean),w=Object.values(v.email).some(Boolean),E=q||w,P=v.password.required||v.password.minLength,D=v.email.required||v.email.email,T=s||E||b;return Object(d.jsxs)("section",{className:"login",children:[Object(d.jsxs)("div",{className:"login__container",children:[Object(d.jsx)("h2",{className:"login__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(d.jsxs)("form",{onSubmit:function(e){e.preventDefault(),f(!0),function(e,t){return fetch("".concat(A,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:e,email:t})}).then((function(e){return e.json()})).then((function(e){return e})).catch((function(e){return console.log(e)}))}(h.password,h.email).then((function(e){e.error||n(!0),t(!0)})).catch((function(e){console.log(e)})).finally((function(){o(!0),f(!1)}))},noValidate:!0,name:"login",className:"form",children:[Object(d.jsxs)("fieldset",{className:"form__fields",children:[Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"email",placeholder:"Email",className:"form__input form__input_location_sign ".concat(s?"":w&&"form__input_type_error"),name:"email",required:!0,id:"email-input",value:y,onChange:S}),Object(d.jsx)("span",{className:"form__error ".concat(s?"":w&&"form__error_visible"),children:D?v.email.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 Email-\u0430\u0434\u0440\u0435\u0441":""})]}),Object(d.jsxs)("label",{className:"label",children:[Object(d.jsx)("input",{type:"text",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",className:"form__input form__input_location_sign ".concat(s?"":q&&"form__input_type_error"),name:"password",required:!0,minLength:2,id:"password-input",value:L,onChange:S}),Object(d.jsx)("span",{className:"form__error ".concat(s?"":q&&"form__error_visible"),children:P?v.password.required?"\u041f\u043e\u043b\u0435 \u043e\u0431\u044f\u0437\u0430\u0442\u0435\u043b\u044c\u043d\u043e \u0434\u043b\u044f \u0437\u0430\u043f\u043e\u043b\u043d\u0435\u043d\u0438\u044f":"\u0412\u0432\u0435\u0434\u0438\u0442\u0435 \u0444\u0440\u0430\u0437\u0443 \u043d\u0435 \u043a\u043e\u0440\u043e\u0447\u0435 ".concat(2," \u0441\u0438\u043c\u0432\u043e\u043b\u043e\u0432"):""})]})]}),Object(d.jsx)("button",{disabled:T,type:"submit",className:"form__button form__button_location_sign ".concat(T&&"form__button_disabled"),children:b?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f...":"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"})]})]}),Object(d.jsx)("div",{className:"login__footer",children:Object(d.jsxs)("p",{className:"login__sign-text",children:["\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b?"," ",Object(d.jsx)(m.b,{to:"/sign-in",className:"login__auth",children:"\u0412\u043e\u0439\u0442\u0438"})]})})]})};var J=function(e){var t=e.email,n=e.onSignOut,a=Object(u.g)();return Object(d.jsx)("div",{className:"burger-menu",children:Object(d.jsxs)("ul",{className:"burger-menu__content",children:[Object(d.jsx)("li",{className:"burger-menu__item",children:Object(d.jsx)("p",{className:"burger__element",children:t})}),Object(d.jsx)("li",{className:"burger-menu__item",children:Object(d.jsx)("button",{onClick:function(){n(),localStorage.removeItem("token"),a.push("/sign-in")},className:"burger__element burger__element_button",children:"\u0412\u044b\u0439\u0442\u0438"})})]})})},F=n.p+"static/media/successful-registration.1b6082f8.svg",V=n.p+"static/media/registration-error.7c6a020b.svg";var M=function(e){var t=e.isOpen,n=e.onClose,a=e.isSuccessfulRegistration,c=e.onRegistrationResolve,i=Object(u.g)();return Object(d.jsx)("section",{className:"popup ".concat(t&&"popup_opened"),children:Object(d.jsxs)("div",{className:"popup__container popup__container_section_registration",children:[Object(d.jsx)("button",{onClick:function(){n(),a&&i.push("/sign-in"),c(!1)},type:"button",className:"popup__button-close popup__button-close_section_registration"}),Object(d.jsx)("img",{className:"popup__registration-image",src:a?F:V,alt:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b!"}),Object(d.jsx)("h2",{className:"popup__title popup__title_section_registration",children:a?"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!":"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."})]})})};var Z=function(){var e=Object(u.g)(),t=Object(a.useState)(!1),n=Object(l.a)(t,2),c=n[0],i=n[1],s=Object(a.useState)(!1),m=Object(l.a)(s,2),b=m[0],f=m[1],O=Object(a.useState)(!1),g=Object(l.a)(O,2),N=g[0],k=g[1],C=Object(a.useState)(!1),y=Object(l.a)(C,2),w=y[0],E=y[1],T=Object(a.useState)(!1),B=Object(l.a)(T,2),R=B[0],F=B[1],V=Object(a.useState)(!1),Z=Object(l.a)(V,2),G=Z[0],$=Z[1],H=Object(a.useState)(null),Y=Object(l.a)(H,2),K=Y[0],Q=Y[1],W=Object(a.useState)({}),X=Object(l.a)(W,2),ee=X[0],te=X[1],ne=Object(a.useState)([]),ae=Object(l.a)(ne,2),ce=ae[0],ie=ae[1],se=Object(a.useState)(!0),re=Object(l.a)(se,2),oe=re[0],le=re[1],ue=Object(a.useState)(!1),me=Object(l.a)(ue,2),de=me[0],je=me[1],be=Object(a.useState)(!1),fe=Object(l.a)(be,2),_e=fe[0],Oe=fe[1],he=Object(a.useState)(!1),pe=Object(l.a)(he,2),ge=pe[0],xe=pe[1],ve=Object(a.useState)(!1),Ne=Object(l.a)(ve,2),ke=Ne[0],Ce=Ne[1],Se=Object(a.useState)(null),Le=Object(l.a)(Se,2),ye=Le[0],qe=Le[1],we=Object(a.useState)(!1),Ee=Object(l.a)(we,2),Pe=Ee[0],De=Ee[1],Te=Object(a.useState)(!1),Ue=Object(l.a)(Te,2),Ae=Ue[0],Be=Ue[1],Ie=Object(a.useState)(!1),Re=Object(l.a)(Ie,2),ze=Re[0],Je=Re[1],Fe=Object(a.useState)(!1),Ve=Object(l.a)(Fe,2),Me=Ve[0],Ze=Ve[1],Ge=Object(a.useState)(!1),$e=Object(l.a)(Ge,2),He=$e[0],Ye=$e[1],Ke=Object(a.useState)(!1),Qe=Object(l.a)(Ke,2),We=Qe[0],Xe=Qe[1];function et(){F(!1),k(!1),E(!1),$(!1),Q(null),f(!1)}Object(a.useEffect)((function(){tt(),P.getInitialData().then((function(e){var t=Object(l.a)(e,2),n=t[0],a=t[1];le(!1),ie(n),te(a)})).catch((function(e){console.log(e)}))}),[]);var tt=function(){localStorage.getItem("token")&&function(e){return fetch("".concat(A,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then((function(e){return e.json()})).then((function(e){return e}))}(localStorage.getItem("token")).then((function(t){Ye((function(e){return Object(r.a)(Object(r.a)({},e),{},{email:t.data.email})})),t&&e.push("/main")}))},nt=function(){Ye(!1),Xe(!1)};return Object(d.jsx)("div",{className:"page ".concat(We&&"page_shift"," ").concat(!He&&"page_without-login"),children:oe?Object(d.jsx)(D,{}):Object(d.jsxs)(_.Provider,{value:ee,children:[Object(d.jsx)(J,{isMenuClick:We,onSignOut:nt,email:He.email}),Object(d.jsx)(j,{onMenuClick:function(){Xe(!We)},onSignOut:nt,email:He.email}),Object(d.jsxs)(u.d,{children:[Object(d.jsx)(U,{path:"/main",loggedIn:He,component:h,cards:ce,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===ee._id}));P.toggleCardLike(e._id,t).then((function(t){ie((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){console.log(e)}))},onCardDelete:function(e){qe(e),$(!0)},onEditProfile:function(){k(!0)},onAddPlace:function(){E(!0)},onEditAvatar:function(){F(!0)},onCardClick:function(e){Q(e)}}),Object(d.jsx)(u.b,{path:"/sign-in",children:Object(d.jsx)(I,{handleLogin:function(){tt(),Ye(!0)}})}),Object(d.jsx)(u.b,{path:"/sign-up",children:Object(d.jsx)(z,{onRegistrationResolve:i,onShowPopup:f})}),Object(d.jsx)(u.b,{path:"/",children:He?Object(d.jsx)(u.a,{to:"/main"}):Object(d.jsx)(u.a,{to:"/sign-in"})})]}),He&&Object(d.jsx)(p,{}),Object(d.jsx)(S,{isLoading:de,onUpdateUser:function(e){De(!0),je(!0),P.setUserInfo(e.name,e.about).then((function(e){te(e),et()})).catch((function(e){console.log(e)})).finally((function(){je(!1),De(!1)}))},isOpen:N,onClose:et,isSubmitting:Pe}),Object(d.jsx)(q,{isLoading:_e,isOpen:w,onAddPlace:function(e){Be(!0),Oe(!0),P.createCard(e.name,e.link).then((function(e){ie([e].concat(Object(o.a)(ce))),et()})).catch((function(e){console.log(e)})).finally((function(){Oe(!1),Be(!1)}))},onClose:et,isSubmitting:Ae}),Object(d.jsx)(x,{isOpen:G,card:ye,onDeleteCard:function(e){Je(!0),Ce(!0),P.deleteCard(e._id).then((function(){ie((function(t){return t.filter((function(t){return t._id!==e._id}))})),et()})).catch((function(e){console.log(e)})).finally((function(){Ce(!1),Je(!1)}))},onClose:et,isLoading:ke,isSubmitting:ze}),Object(d.jsx)(v,{card:K,onClose:et}),Object(d.jsx)(L,{isLoading:ge,isOpen:R,onUpdateAvatar:function(e){Ze(!0),xe(!0),P.updateAvatar(e.avatar).then((function(e){te(e),et()})).catch((function(e){console.log(e)})).finally((function(){xe(!1),Ze(!1)}))},onClose:et,isSubmitting:Me}),Object(d.jsx)(M,{onClose:et,isOpen:b,isSuccessfulRegistration:c,onRegistrationResolve:i})]})})},G=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,i=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),i(e),s(e)}))};s.a.render(Object(d.jsx)(c.a.StrictMode,{children:Object(d.jsx)(m.a,{children:Object(d.jsx)(Z,{})})}),document.getElementById("root")),G()}},[[37,1,2]]]);
//# sourceMappingURL=main.5b6aef19.chunk.js.map